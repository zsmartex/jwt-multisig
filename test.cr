require "./src/jwt-multisig"

payload = {
  exp:  Time.local.to_unix,
  data: {} of String => String
}

public_key = "LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUF3ajdyY1dERjl0d1RPZmt6RHlIZQpEdjlyWDZIQnJEa1VUSklsVmQzNnk0dnIvU1pkdDhkTFdidUxlb0ZtaHdNK1BGWnNubVJhYzljeHB4cmJsV0Q2CmdsN1B6RFNpK1NYTGFPOVdmY0lJYlM2a1cxT3ViclZoRTg4VUFZLzlIREUxbWZ1ZzJUVmtWMmRCSFU1dGwxZDAKTEZqOHVMa3Y0ZUozREVRb1RHdUk0UHBFN3hxTDBzNndabmo1VXArcUNDRmpzNWpPTWUrV0h2YTlhRVhTVU1GVgpvYkFSVnB1S3VQSUQ0SW1xMEJ1THlLMlJZRDRuY1RMSmRGVUQ3K3VuQ044Rm1PUXNYMy9pcENUclV0dlVxWHNpCk16WW9pdExqNkpMalI3S3FMbENicjdRMGlwZHFyMWNaT0Z0ZVpydU1JcHNaYnJvZHNKRis0QnMvMk9SMUdNSkQKY3dJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tCg=="
private_key = "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBd2o3cmNXREY5dHdUT2ZrekR5SGVEdjlyWDZIQnJEa1VUSklsVmQzNnk0dnIvU1pkCnQ4ZExXYnVMZW9GbWh3TStQRlpzbm1SYWM5Y3hweHJibFdENmdsN1B6RFNpK1NYTGFPOVdmY0lJYlM2a1cxT3UKYnJWaEU4OFVBWS85SERFMW1mdWcyVFZrVjJkQkhVNXRsMWQwTEZqOHVMa3Y0ZUozREVRb1RHdUk0UHBFN3hxTAowczZ3Wm5qNVVwK3FDQ0ZqczVqT01lK1dIdmE5YUVYU1VNRlZvYkFSVnB1S3VQSUQ0SW1xMEJ1THlLMlJZRDRuCmNUTEpkRlVENyt1bkNOOEZtT1FzWDMvaXBDVHJVdHZVcVhzaU16WW9pdExqNkpMalI3S3FMbENicjdRMGlwZHEKcjFjWk9GdGVacnVNSXBzWmJyb2RzSkYrNEJzLzJPUjFHTUpEY3dJREFRQUJBb0lCQURXcUlHM3dhSUR0Q0RySwpDRHMwQmg5cW5ZV01NTytkeldmaU1JSnFrM0ZNdE9QNWg0YlFmcGJKNDV6eXh4cWg0TDNXdXFkLzNpV0czR2JvCldxWUladTFCdUhNWVQ3WTVwTnJXMUxSbHVPSkJNcE13cVU1WXVmczVDTFB0emVYT0Nwc0NFOHd1bmd3dnNLT2kKR1ZEb2ptWDZKOGY1RWF0OFg1dDU4UkE3M1ZNYUZsc3ZleXB1eVRUVjRmWTIrRlJXMjRBVjdYMHUwTnZnNmt2OQo2YnIxU0Z3cjlaNTNNaVJyWGhZek5mZXFyRXNMR1VubWlhazFYdDJJRkY0MnZJZkdKUWF4QVRrcTlWdENsOEZoClRROFMydTJ0cmtybVlFMloyNTdwTWhTckw1OVMyL1pCa2dQMVNkcy9QRGJqdkp2OVd3cTV5NjNlenBtb0JsNjgKNkhpc1BERUNnWUVBNGYweWRXUmU1QVhKTmNPZy9MM3lOaGtwVlhSRDNROHdOYkNvc2h0dU9MQ00zQ1o4Z2Z4MQpxNTN6WURyWmVqSWxhTGNRTjVPcFg1ZFEwaCtJSzRRWHFIei9YajFKcVR2N0x4c2k1eUVBdEdhZUwydjZudHUwCmZiU05zUVd0VW84NU9nejdJaHAwUkpMMDlsZmtNYy9MRU1lOGsxbmF4Q3hEd09qWXNROG9FK2NDZ1lFQTNBcVIKTm4veEFWajZ4aUZubTh1bTcvanJpR3RnczNQcEt3bWxJZVNGTS9DS0Izd2U2WlJXaDdBenhNbXRJU1VXNXF5aAp2Y0t2dXFQK3AwMzd4dDlDTVJHRDdSK3hTRWNwMVgrZVFXMnNCMEdEcEVkTkVaenhST2NsaGxvdzdQWkJNRUp1CmNQRGJEbzA4T1RNZld3R0syZmJkR1pJMElwNEgyY2lxUHhTbUlwVUNnWUJxbERzRDJqNVdVOVE5SXZIOXdLZEcKbEQ5R0tmc0hlbTVHSS9hcmFQeG1oLzBtcG8vNXpkTEJDVkVLaFRhanhwcVY5Q0FWMWZIL1B5SEN0MVJGRVpzRwp2MHpBYVM4Z1BVV05SY01FTmpCYTVEcWVLdEtic1FwQ2JyQ1VXQlVSNXJJYWlweTF6THdneXgzMFFDZEN4cmtDClJQRE9uWVhyRnVVdFNhTklmZGxzNlFLQmdHU2ZESEtBcFNQNW5ZdVc0UHMwY0oxU0Zkcm5SMndvZUJxdktXMUwKUThKUm43ejJmR2hSNWhQY2RuL3B2WnJuakFabU1QeEdsL2RnWU9YKzJrREIvVkhVOGFBd212QXpZcVQzMjlXTgpvbG9iRW1qQUZqVVVzSnZTbTYxSmR4QVZPQkFxZ0xoeTI2bFcycEJKbVhBVFQzeUd6K3FPbWZxdWkyYUN4WjlkCkFPL1ZBb0dBRnFLTHVEd0FwRWk1a1ozSFZPU0JtT1J5d3kwaW9ibEtwbU5HeUlwbjg3b2RSZVN1dDZySENjRHgKb29vdm9oYmlNUkVYWndLOU5TTGt6ZFltOFdPdUFmRVZicDJQbWdLOG1OYmxmb2N4T3o0Z1BRRXZGcU5rSjZkdwpTaFZWYStwNUtzRDFDN2xScG4yajA3cnh6UnMwb2h0TzZDbVNJcGVOWkMrYm14TDNTNVU9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg=="

public_keychain = {
  "applogic" => Base64.decode_string(public_key)
}

private_keychain = {
  "applogic" => Base64.decode_string(private_key)
}

algorithms = {
  "applogic" => JWT::Algorithm::RS256
}

# jwt = JWT.encode(payload, private_keychain["applogic"], algorithms["applogic"]).split(".")

jwt = JWT::Multisig.generate_jwt(payload, private_keychain, algorithms)

# puts jwt.to_json

puts JWT::Multisig.verify_jwt(JSON.parse(jwt.to_json), public_keychain)

# payload_base64 = JWT::Multisig.base64_encode(payload.to_json)
# puts JWT::Multisig.base64_decode(payload_base64)
